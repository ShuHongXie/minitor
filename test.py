┌─────────────────────────────────────────────────────────────────────────────┐
│                              前端应用（Web/H5/小程序）                        │
└───────────────────────────┬─────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                         前端 SDK（采集层）                                  │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────────────┐  │
│  │ JS错误  │  │ 性能指标 │  │ 用户行为 │  │ 接口请求 │  │ 白屏/卡顿/崩溃  │  │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  └─────────────────┘  │
│  （上报：图片打点 / fetch / Beacon）                                        │
└───────────────────────────┬─────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                         接入网关 / 上报服务（API Gateway）                    │
│  （限流、鉴权、数据清洗、格式校验、防刷、IP/UA解析）                         │
└───────────────────────────┬─────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                             Kafka 消息队列【核心位置】                        │
│  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐                 │
│  │ error-topic    │  │ performance    │  │ behavior       │                 │
│  │ (错误日志)     │  │ (性能指标)     │  │ (用户行为)      │                 │
│  └────────────────┘  └────────────────┘  └────────────────┘                 │
└───────────────────────────┬─────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                          实时消费 / 流处理层                                │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐              │
│  │ 错误聚合消费    │  │ 性能指标计算     │  │ 接口耗时统计    │              │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘              │
│  （Flink / Spark / 自定义消费程序）                                          │
└───────────────────────────┬─────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              存储层                                         │
│  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐  ┌──────────┐   │
│  │ 时序数据库     │  │ Elasticsearch  │  │ 关系型数据库   │  │  Redis   │   │
│  │ (Prometheus/   │  │ / OpenSearch   │  │ (MySQL/PG)      │  │ （缓存） │   │
│  │  InfluxDB）    │  │ （日志检索）   │  │ （元信息）     │  │          │   │
│  └────────────────┘  └────────────────┘  └────────────────┘  └──────────┘   │
└───────────────────────────┬─────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           服务层                                            │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐              │
│  │ 数据查询服务    │  │ 告警规则引擎    │  │ 日志检索服务    │              │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘              │
└───────────────────────────┬─────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           应用层                                            │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐              │
│  │ 监控大盘        │  │ 错误分析        │  │ 性能分析        │              │
│  │ （Grafana/自研） │  │                  │  │                  │              │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘              │
│  ┌─────────────────────────────────────────────────────────────┐            │
│  │ 告警通知（邮件/企业微信/钉钉/短信）                          │            │
│  └─────────────────────────────────────────────────────────────┘            │
└─────────────────────────────────────────────────────────────────────────────┘